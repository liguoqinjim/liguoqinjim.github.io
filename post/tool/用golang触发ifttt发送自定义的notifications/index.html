<!DOCTYPE html>
<html lang="zh-cn" itemscope itemtype="http://schema.org/WebPage">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>用golang触发IFTTT，发送自定义的Notifications - LI的技术笔记</title>
  

<meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta name="MobileOptimized" content="width"/>
<meta name="HandheldFriendly" content="true"/>


<meta name="applicable-device" content="pc,mobile">

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="mobile-web-app-capable" content="yes">

<meta name="author" content="liguoqinjim" />
  <meta name="description" content="IFTTT众多的service里面，有一个非常强大的service，就是webhooks。当我们在IFTTT里面connect了这个service之后，我们会得到一个唯一的链接，我们访问这个链接就会被视作触发了这个service。
" />







<meta name="generator" content="Hugo 0.58.3" />


<link rel="canonical" href="https://liguoqinjim.cn/post/tool/%E7%94%A8golang%E8%A7%A6%E5%8F%91ifttt%E5%8F%91%E9%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84notifications/" />





<link rel="icon" href="https://liguoqinjim.cn/favicon.ico" />











<link rel="stylesheet" href="https://liguoqinjim.cn/sass/jane.min.af20b78e95c84de86b00a0242a4a77bd2601700e1b250edf27537d957ac0041d.css" integrity="sha256-ryC3jpXITehrAKAkKkp3vSYBcA4bJQ7fJ1N9lXrABB0=" media="screen" crossorigin="anonymous">





<meta property="og:title" content="用golang触发IFTTT，发送自定义的Notifications" />
<meta property="og:description" content="IFTTT众多的service里面，有一个非常强大的service，就是webhooks。当我们在IFTTT里面connect了这个service之后，我们会得到一个唯一的链接，我们访问这个链接就会被视作触发了这个service。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://liguoqinjim.cn/post/tool/%E7%94%A8golang%E8%A7%A6%E5%8F%91ifttt%E5%8F%91%E9%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84notifications/" />
<meta property="article:published_time" content="2018-07-02T18:20:02+08:00" />
<meta property="article:modified_time" content="2018-07-02T18:20:02+08:00" />
<meta itemprop="name" content="用golang触发IFTTT，发送自定义的Notifications">
<meta itemprop="description" content="IFTTT众多的service里面，有一个非常强大的service，就是webhooks。当我们在IFTTT里面connect了这个service之后，我们会得到一个唯一的链接，我们访问这个链接就会被视作触发了这个service。">


<meta itemprop="datePublished" content="2018-07-02T18:20:02&#43;08:00" />
<meta itemprop="dateModified" content="2018-07-02T18:20:02&#43;08:00" />
<meta itemprop="wordCount" content="368">



<meta itemprop="keywords" content="tool,golang," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="用golang触发IFTTT，发送自定义的Notifications"/>
<meta name="twitter:description" content="IFTTT众多的service里面，有一个非常强大的service，就是webhooks。当我们在IFTTT里面connect了这个service之后，我们会得到一个唯一的链接，我们访问这个链接就会被视作触发了这个service。"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-113128130-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="https://liguoqinjim.cn/" class="logo">LI的技术笔记</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://liguoqinjim.cn/">Home</a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/liguoqinjim" rel="noopener" target="_blank">
              Works
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          
        
      </li><li class="mobile-menu-item">
        
          
          
            <a class="menu-item-link" href="https://liguoqinjim.cn/tags/">Tags</a>
          
        
      </li>
    

    
  </ul>
</nav>


  

  

  

  <header id="header" class="header container">
    <div class="logo-wrapper">
  <a href="https://liguoqinjim.cn/" class="logo">
    
      LI的技术笔记
    
  </a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://liguoqinjim.cn/">Home</a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://github.com/liguoqinjim" rel="noopener" target="_blank">
              Works
              
              <i class="iconfont">
                <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6C496.064 467.648 528.64 500.224 528.64 500.224 534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92 0 0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"></path>
  <path d="M841.152 457.152c-30.528 0-54.784 24.512-54.784 54.656l0 274.752L237.696 786.56 237.696 237.696l206.016 0c6.656 0 10.752 0 13.248 0C487.68 237.696 512 213.184 512 182.848 512 152.32 487.36 128 456.96 128L183.04 128C153.216 128 128 152.576 128 182.848c0 3.136 0.256 6.272 0.768 9.28C128.256 195.136 128 198.272 128 201.408l0 639.488c0 0.064 0 0.192 0 0.256 0 0.128 0 0.192 0 0.32 0 30.528 24.512 54.784 54.784 54.784l646.976 0c6.592 0 9.728 0 11.712 0 28.736 0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344l0-20.352L896 561.408 896 512.128C896 481.792 871.424 457.152 841.152 457.152z"></path>
</svg>

              </i>
            </a>
          

        

      </li>
    
        <li class="menu-item">
        
          
          
            <a class="menu-item-link" href="https://liguoqinjim.cn/tags/">Tags</a>
          

        

      </li>
    

    
    

    
  </ul>
</nav>

  </header>

  <div id="mobile-panel">
    <main id="main" class="main bg-llight">
      <div class="content-wrapper">
        <div id="content" class="content container">
          <article class="post bg-white">
    
    <header class="post-header">
      <h1 class="post-title">用golang触发IFTTT，发送自定义的Notifications</h1>
      
      <div class="post-meta">
        <time datetime="2018-07-02" class="post-time">
          2018-07-02
        </time>
        
        

        
        

        
        
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title"></h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
<ul>
<li><a href="#1-创建applet">1.创建Applet</a>
<ul>
<li><a href="#1-1新建applet">1.1新建Applet</a></li>
<li><a href="#1-2选择webhooks作为service">1.2选择webhooks作为service</a></li>
<li><a href="#1-3选择receive-a-web-request作为trigger">1.3选择Receive a web request作为trigger</a></li>
<li><a href="#1-4设置一个-event-name">1.4设置一个<code>Event Name</code></a></li>
<li><a href="#1-5选择action-service">1.5选择action service</a></li>
<li><a href="#1-6选择一个action">1.6选择一个action</a></li>
<li><a href="#1-7配置action">1.7配置action</a></li>
</ul></li>
<li><a href="#2-触发webhooks">2.触发webhooks</a>
<ul>
<li><a href="#2-1使用webhooks的documentation里面的测试来触发">2.1使用webhooks的Documentation里面的测试来触发</a></li>
<li><a href="#2-2使用curl来触发">2.2使用curl来触发</a></li>
<li><a href="#2-3使用golang来触发">2.3使用golang来触发</a>
<ul>
<li><a href="#2-3-1http-post实现">2.3.1http.Post实现</a></li>
<li><a href="#2-3-2http-client的方式">2.3.2http.Client的方式</a></li>
<li><a href="#2-3-3使用gorequest库">2.3.3使用gorequest库</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <p>IFTTT众多的service里面，有一个非常强大的service，就是webhooks。当我们在IFTTT里面connect了这个service之后，我们会得到一个唯一的链接，我们访问这个链接就会被视作触发了这个service。</p>

<!-- toc -->

<h1 id="1-创建applet">1.创建Applet</h1>

<h2 id="1-1新建applet">1.1新建Applet</h2>

<p>在<code>My Applets</code>界面选择<code>New Applet</code>，然后选择<code>+this</code></p>

<h2 id="1-2选择webhooks作为service">1.2选择webhooks作为service</h2>

<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_154911.png -->

<!-- ![选择webhooks作为service](/images/IFTTT/snipaste20180703_154911.png) -->

<p><img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_154911.png" width="500" alt="选择webhooks作为service"></p>

<h2 id="1-3选择receive-a-web-request作为trigger">1.3选择Receive a web request作为trigger</h2>

<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_155431.png -->

<!-- ![选择Receive a web request作为trigger](/images/IFTTT/snipaste20180703_155431.png) -->

<p><img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_155431.png" width="750" alt="选择Receive a web request作为trigger"></p>

<h2 id="1-4设置一个-event-name">1.4设置一个<code>Event Name</code></h2>

<p>为webhooks设置一个<code>Event Name</code>，作为这个Applet的触发条件。因为可能另外的Applet也用了webhooks这个service，那么就要使用这个<code>Event Name</code>来区分到底是哪个Applet
<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_173058.png -->
<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_161526.png -->
<!-- ![设置一个Event Name](/images/IFTTT/snipaste20180703_161526.png) -->
<img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_173058.png" width="500" alt="设置一个Event Name"></p>

<h2 id="1-5选择action-service">1.5选择action service</h2>

<p>IFTTT里面，最终的动作被称作action。我们现在已经选好了webhooks作为trigger，现在就要来选择action了。我们选择<code>Notifications</code>作为action service
<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_162444.png -->
<!-- ![选择action service](/images/IFTTT/snipaste20180703_162444.png) -->
<img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_162444.png" width="500" alt="选择action service"></p>

<h2 id="1-6选择一个action">1.6选择一个action</h2>

<p><code>Notifications</code>这个service有两个action，一个是普通的通知，另一个是富文本的通知，也就是可以在通知里面显示图片。我们这里选择富文本的通知，普通通知的用法也是类似的
<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_163859.png -->
<!-- ![选择一个action](/images/IFTTT/snipaste20180703_163859.png) -->
<img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_163859.png" width="750" alt="选择一个action"></p>

<h2 id="1-7配置action">1.7配置action</h2>

<p>配置action，可以设置<code>Notifications</code>的标题还有内容，还可以设置要显示的图片。这里还可以使用<code>Add ingredient</code>来添加webhooks里面传过来的数据。配置完成之后我们create，然后finish，Applet就创建完成了
<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_164610.png -->
<!-- ![配置action](/images/IFTTT/snipaste20180703_164610.png) -->
<img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_164610.png" width="500" alt="配置action"></p>

<h1 id="2-触发webhooks">2.触发webhooks</h1>

<h2 id="2-1使用webhooks的documentation里面的测试来触发">2.1使用webhooks的Documentation里面的测试来触发</h2>

<p>一开始的时候，我们可以使用这个测试模式来测试自己的配置是否正确。访问<a href="https://ifttt.com/maker_webhooks">webhooks</a>页面，选择<code>Documentation</code>。输入之前设置好的<code>Event Name</code>，然后在下面的内容里面也可以填，<code>value1</code>、<code>value2</code>这些值都是可以在action的配置里面得到的。之前我们配置了<code>value1</code>的值是填要在通知里面显示的图片地址。填好之后按<code>Test it</code>
<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_171859.png -->
<!-- ![webhooks测试](/images/IFTTT/snipaste20180703_171859.png) -->
<img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_171859.png" width="900" alt="webhooks测试"></p>

<p>收到的通知
<!-- E:\Workspace\hugo_site\static\img\IFTTT\notifications1.jpg -->
<!-- ![notifications1](/images/IFTTT/notifications1.jpg) -->
<img src="https://liguoqinjim.cn/images/IFTTT/notifications1.jpg" width="300" alt="notifications1"></p>

<h2 id="2-2使用curl来触发">2.2使用curl来触发</h2>

<p>我们在2.1里面的测试界面也可以得到自动生成好的curl命令。我们直接拿来使用即可。</p>

<!-- E:\Workspace\hugo_site\static\img\IFTTT\snipaste20180703_173541.png -->

<!-- ![curl测试](/images/IFTTT/snipaste20180703_173541.png) -->

<p><img src="https://liguoqinjim.cn/images/IFTTT/snipaste20180703_173541.png" width="900" alt="curl测试"></p>

<p>收到的通知
<!-- E:\Workspace\hugo_site\static\img\IFTTT\notifications2.jpg -->
<!-- ![notifications1](/images/IFTTT/notifications2.jpg) -->
<img src="https://liguoqinjim.cn/images/IFTTT/notifications2.jpg" width="300" alt="notifications1"></p>

<h2 id="2-3使用golang来触发">2.3使用golang来触发</h2>

<p>所有的代码都放在github上了，地址<code>https://github.com/liguoqinjim/go-labs/tree/master/lab143</code></p>

<h3 id="2-3-1http-post实现">2.3.1http.Post实现</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>

<span style="color:#f92672">import</span> (
	<span style="color:#e6db74">&#34;bytes&#34;</span>
	<span style="color:#e6db74">&#34;encoding/json&#34;</span>
	<span style="color:#e6db74">&#34;fmt&#34;</span>
	<span style="color:#e6db74">&#34;io/ioutil&#34;</span>
	<span style="color:#e6db74">&#34;log&#34;</span>
	<span style="color:#e6db74">&#34;net/http&#34;</span>
)

<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ConfStruct</span> <span style="color:#66d9ef">struct</span> {
	<span style="color:#a6e22e">Key</span>       <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;key&#34;`</span>
	<span style="color:#a6e22e">EventName</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;event_name&#34;`</span>
	<span style="color:#a6e22e">UrlFormat</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;url_format&#34;`</span>
	<span style="color:#a6e22e">Value1</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value1&#34;`</span>
	<span style="color:#a6e22e">Value2</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value2&#34;`</span>
	<span style="color:#a6e22e">Value3</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value3&#34;`</span>
}

<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">conf</span> = new(<span style="color:#a6e22e">ConfStruct</span>)

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">//读取配置文件
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadFile</span>(<span style="color:#e6db74">&#34;conf.json&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;ioutil.ReadFile error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;data=\n%s&#34;</span>, <span style="color:#a6e22e">data</span>)

	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">conf</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;json.Unmarshal error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#75715e">//拼接url
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">u</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">UrlFormat</span>, <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">EventName</span>, <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Key</span>)
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;url=%s&#34;</span>, <span style="color:#a6e22e">u</span>)

	<span style="color:#75715e">//post
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">values</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;value1&#34;</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value1</span>, <span style="color:#e6db74">&#34;value2&#34;</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value2</span>, <span style="color:#e6db74">&#34;value3&#34;</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value3</span>}
	<span style="color:#a6e22e">jsonStr</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">values</span>)
	<span style="color:#a6e22e">resp</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#a6e22e">u</span>, <span style="color:#e6db74">&#34;application/json&#34;</span>, <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">NewBuffer</span>(<span style="color:#a6e22e">jsonStr</span>))
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;http.Post error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">d</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Body</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;ioutil.ReadAll error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;resp:\n%s&#34;</span>, <span style="color:#a6e22e">d</span>)
}</code></pre></div>
<h3 id="2-3-2http-client的方式">2.3.2http.Client的方式</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#f92672">...</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">//读取配置文件
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadFile</span>(<span style="color:#e6db74">&#34;conf.json&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;ioutil.ReadFile error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;data=\n%s&#34;</span>, <span style="color:#a6e22e">data</span>)

	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">conf</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;json.Unmarshal error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#75715e">//拼接url
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">u</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">UrlFormat</span>, <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">EventName</span>, <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Key</span>)
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;url=%s&#34;</span>, <span style="color:#a6e22e">u</span>)

	<span style="color:#75715e">//client
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">client</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Client</span>{}
	<span style="color:#a6e22e">values</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{
		<span style="color:#e6db74">&#34;value1&#34;</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value1</span>,
		<span style="color:#e6db74">&#34;value2&#34;</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value2</span>,
		<span style="color:#e6db74">&#34;value3&#34;</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value3</span>,
	}
	<span style="color:#a6e22e">jsonStr</span>, <span style="color:#a6e22e">_</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Marshal</span>(<span style="color:#a6e22e">values</span>)

	<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">NewRequest</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">MethodPost</span>, <span style="color:#a6e22e">u</span>, <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">NewBuffer</span>(<span style="color:#a6e22e">jsonStr</span>))
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;http.NewRequest error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">Header</span>.<span style="color:#a6e22e">Add</span>(<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;application/json&#34;</span>)

	<span style="color:#a6e22e">resp</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">client</span>.<span style="color:#a6e22e">Do</span>(<span style="color:#a6e22e">req</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;client.Do error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">d</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Body</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;ioutil.ReadAll error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;resp:\n%s&#34;</span>, <span style="color:#a6e22e">d</span>)
}</code></pre></div>
<h3 id="2-3-3使用gorequest库">2.3.3使用gorequest库</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#f92672">...</span>

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
	<span style="color:#75715e">//读取配置文件
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadFile</span>(<span style="color:#e6db74">&#34;conf.json&#34;</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;ioutil.ReadFile error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;data=\n%s&#34;</span>, <span style="color:#a6e22e">data</span>)

	<span style="color:#a6e22e">err</span> = <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">Unmarshal</span>(<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">conf</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;json.Unmarshal error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}

	<span style="color:#75715e">//拼接url
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">u</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">UrlFormat</span>, <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">EventName</span>, <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Key</span>)
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;url=%s&#34;</span>, <span style="color:#a6e22e">u</span>)

	<span style="color:#66d9ef">type</span> <span style="color:#a6e22e">ValueStruct</span> <span style="color:#66d9ef">struct</span> {
		<span style="color:#a6e22e">Value1</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value1&#34;`</span>
		<span style="color:#a6e22e">Value2</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value2&#34;`</span>
		<span style="color:#a6e22e">Value3</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value3&#34;`</span>
	}
	<span style="color:#a6e22e">val</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ValueStruct</span>{<span style="color:#a6e22e">Value1</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value1</span>, <span style="color:#a6e22e">Value2</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value2</span>, <span style="color:#a6e22e">Value3</span>: <span style="color:#a6e22e">conf</span>.<span style="color:#a6e22e">Value3</span>}
	<span style="color:#a6e22e">request</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">gorequest</span>.<span style="color:#a6e22e">New</span>()
	<span style="color:#75715e">//http://httpbin.org/post
</span><span style="color:#75715e"></span>	<span style="color:#a6e22e">resp</span>, <span style="color:#a6e22e">body</span>, <span style="color:#a6e22e">errs</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#a6e22e">u</span>).
		<span style="color:#a6e22e">Send</span>(<span style="color:#a6e22e">val</span>).
		<span style="color:#a6e22e">End</span>()
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">errs</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;errs:%+v&#34;</span>, <span style="color:#a6e22e">errs</span>)
	}
	<span style="color:#a6e22e">d</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ioutil</span>.<span style="color:#a6e22e">ReadAll</span>(<span style="color:#a6e22e">resp</span>.<span style="color:#a6e22e">Body</span>)
	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;ioutil.ReadAll error:%v&#34;</span>, <span style="color:#a6e22e">err</span>)
	}
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Printf</span>(<span style="color:#e6db74">&#34;resp=\n%s&#34;</span>, <span style="color:#a6e22e">d</span>)
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;body.length=&#34;</span>, len(<span style="color:#a6e22e">body</span>))
	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;body=&#34;</span>, <span style="color:#a6e22e">body</span>)
}</code></pre></div>
    </div>

    
    


    
    

    <footer class="post-footer">
      <div class="post-tags">
          <a href="https://liguoqinjim.cn/tags/tool/">tool</a>
          <a href="https://liguoqinjim.cn/tags/golang/">golang</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="https://liguoqinjim.cn/post/markdown/%E8%AE%BE%E7%BD%AEmarkdown%E9%87%8C%E9%9D%A2%E7%9A%84%E5%9B%BE%E7%89%87%E5%A4%A7%E5%B0%8F/">
            
            <i class="iconfont">
              <svg  class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417 757.434875 204.940602c11.338233-12.190647 11.035334-32.285311-0.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-0.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891 0.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"></path>
</svg>

            </i>
            <span class="prev-text nav-default">设置markdown里面的图片大小</span>
            <span class="prev-text nav-mobile"></span>
          </a>
        
          <a class="next" href="https://liguoqinjim.cn/post/tool/hugo%E7%9A%84%E4%BD%BF%E7%94%A8/">
            <span class="next-text nav-default">Hugo的使用</span>
            <span class="prev-text nav-mobile"></span>
            
            <i class="iconfont">
              <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="18" height="18">
  <path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311 0.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889 0.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-0.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697C361.493148 60.273758 343.054193 61.470003 332.091514 74.487481z"></path>
</svg>

            </i>
          </a>
      </nav>
    </footer>
  </article>

  
  

  
  

  

  
  

  

  

  <div class="disqus-comment">
  <div class="disqus-button" id="load_disqus" onclick="load_disqus()">
    
  </div>
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_config = function () {
      this.page.url = "https://liguoqinjim.cn/post/tool/%E7%94%A8golang%E8%A7%A6%E5%8F%91ifttt%E5%8F%91%E9%80%81%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84notifications/";
    };
    function load_disqus() {
      
      
      if (window.location.hostname === 'localhost') return;

      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      var disqus_shortname = 'liguoqinjim';
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);

      $('#load_disqus').remove();
    };
  </script>
  <noscript>Please enable JavaScript to view the
    <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
  </noscript>
  
  </div>

    

  

        </div>
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="icon-links">
  


<a href="https://liguoqinjim.cn/index.xml" rel="noopener alternate" type="application/rss&#43;xml"
    class="iconfont" title="rss" target="_blank">
    <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="30" height="30">
  <path d="M819.157333 1024C819.157333 574.592 449.408 204.8 0 204.8V0c561.706667 0 1024 462.293333 1024 1024h-204.842667zM140.416 743.04a140.8 140.8 0 0 1 140.501333 140.586667A140.928 140.928 0 0 1 140.074667 1024C62.72 1024 0 961.109333 0 883.626667s62.933333-140.544 140.416-140.586667zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667V345.173333c372.352 0 678.784 306.517333 678.784 678.826667z"></path>
</svg>

  </a>
   
</div>

<div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" href="https://gohugo.io">Hugo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - <a class="theme-link" href="https://github.com/xianmin/hugo-theme-jane">Jane</a>
  </span>

  <span class="copyright-year">
    &copy;
    
       -
    2020
    <span class="heart">
      
      <i class="iconfont">
        <svg class="icon" viewBox="0 0 1025 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="14" height="14">
  <path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7 0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1 0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2 0.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2 0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3 0.1-42.5-8-83.6-24-122.2z"
   fill="#8a8a8a"></path>
</svg>

      </i>
    </span><span class="author">
        © This post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License，please give source if you wish to quote or reproduce.
        
      </span></span>

  
  

  
    <span>
      <a href='http://www.beian.miit.gov.cn'>沪ICP备19042199号-1</a>
    </span>
  
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont">
        
        <svg class="icon" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
  width="35" height="35">
  <path d="M510.866688 227.694839 95.449397 629.218702l235.761562 0-2.057869 328.796468 362.40389 0L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777l894.052392 0 0 131.813095L63.840492 195.775872 63.840492 63.962777 63.840492 63.962777zM63.840492 63.962777"></path>
</svg>

      </i>
    </div>
  </div>
  
<script type="text/javascript" src="https://liguoqinjim.cn/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="https://liguoqinjim.cn/lib/slideout/slideout-1.0.1.min.js"></script>




<script type="text/javascript" src="https://liguoqinjim.cn/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js" integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin="anonymous"></script>


























</body>
</html>
